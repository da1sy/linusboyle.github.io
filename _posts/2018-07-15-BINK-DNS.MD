---
title: CentOS6.5 DNS服务器搭建
date: 2018-07-15
tags: Linux
layout: post
---


1.安装bind
--------

--------


>yum install -y bind


2.修改`named.conf`主配置文件
---------------------


>vim /etc/named.conf


编辑为
```shell
options {
        listen-on port 53 { any; };       #监听在这台主机系统上面的哪个网络借口。默认是监听在localhost，即只有本机可以对DNS服务进行查询
        listen-on-v6 port 53 { ::1; };
        directory       "/var/named";
        dump-file       "/var/named/data/cache_dump.db";
        statistics-file "/var/named/data/named_stats.txt";
        memstatistics-file "/var/named/data/named_mem_stats.txt";
        allow-query     { any; };       #针对客户端的设置，表示到底谁可以对我的DNS服务提出查询请，原文为localhost，改为any
        recursion yes;

        dnssec-enable yes;
        dnssec-validation yes;
        dnssec-lookaside auto;

        /* Path to ISC DLV key */
        bindkeys-file "/etc/named.iscdlv.key";

        managed-keys-directory "/var/named/dynamic";
};
...

```


3.配置正向、反向解析
-----------


>vim /etc/named.rfc1912.zones

添加以下两条
![这里写图片描述](https://img-blog.csdn.net/20180715165647111?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2RhMXN5ZGExc3k=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)
正向解析格式为：

```
zone "da1sy.com" IN {
        type master;
        file "z";    //正向解析的文件名要与下面创建的文件名对应
};
```
反向解析格式：
```
zone "150.169.192.in-addr.arpa" IN {  //前面为服务器IP地址的反写后面加上".in-addr.arpa"
        type master;
        file "f";    //反向解析的文件名要与下面创建的文件名对应
};
```

4.创建解析文件
--------

>在`/var/named/`下创建文件  **z**

编辑文件为

```shell
$TTL 1D
@       IN SOA  @ rname.invalid. (
                                        0       ; serial
                                        1D      ; refresh
                                        1H      ; retry
                                        1W      ; expire
                                        3H )    ; minimum
@               IN      NS      www.da1sy.com.
www.da1sy.com.  IN      A       192.168.150.11
```
>再创建文件**f**

编辑为

```shell
$TTL 1D
@       IN SOA  @ rname.invalid. (
                                        0       ; serial
                                        1D      ; refresh
                                        1H      ; retry
                                        1W      ; expire
                                        3H )    ; minimum
@       NS      www.da1sy.com.
11      PTR     www.da1sy.com.
```

5.更改主机地址和名称
-----------


>vim /etc/resolv.conf


```shell
# Generated by NetworkManager
domain da1sy.com
search localdomain
nameserver 192.168.150.11

```

最后nslookup一下，域名和IP都没问题，大功告成 ^.^
![这里写图片描述](https://img-blog.csdn.net/20180715200206157?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2RhMXN5ZGExc3k=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)

如果发现解析不到的情况，可能是没有文件没有权限，可以chmod 777
